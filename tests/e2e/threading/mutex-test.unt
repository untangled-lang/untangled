thread_def First {
  semaphore sem;
  receive {
    semaphore s -> sem = s;
    _ -> {}
  }
  print("First\n");
  sem++;
  parent << 0;
}

thread_def Second {
  semaphore sem;
  receive {
    semaphore s -> sem = s;
    _ -> {}
  }
  sem--;
  print("Second\n");
  parent << 0;
}

thread_def Main {
  semaphore sem = make_semaphore(0);
  thread s = spawn Second;
  s << sem;
  for (int i = 0; i < 100000; i++) {
    int delay = i;
  }
  thread f = spawn First;
  f << sem;
  receive {_ -> {}}
  receive {_ -> {}}
}
