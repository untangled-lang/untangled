Finish semaphore wait/post without deadlock
